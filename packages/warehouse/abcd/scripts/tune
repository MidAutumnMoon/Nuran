#!/bin/sh

cat >> /etc/sysctl.d/999-teapot.conf << EOF
net.ipv4.tcp_slow_start_after_idle=0
net.ipv4.tcp_frto=0
net.ipv4.tcp_mtu_probing=1
net.ipv4.tcp_sack=1
net.ipv4.tcp_fack=1
net.ipv4.tcp_window_scaling=1
net.ipv4.tcp_adv_win_scale=1
net.ipv4.tcp_moderate_rcvbuf=1
net.core.rmem_default=87380
net.core.rmem_max=26214400
net.core.wmem_default=87380
net.core.wmem_max=26214400
net.ipv4.tcp_rmem=8192 87380 26214400
net.ipv4.tcp_wmem=8192 87380 26214400
net.ipv4.udp_mem=8192 87380 26214400
net.ipv4.udp_rmem_min=8192
net.ipv4.udp_wmem_min=8192
net.core.default_qdisc=fq
net.ipv4.tcp_congestion_control=bbr
net.core.netdev_max_backlog=10240
net.ipv4.tcp_max_syn_backlog=8192
net.ipv4.tcp_notsent_lowat=32768
EOF

sysctl --load && sysctl --system
